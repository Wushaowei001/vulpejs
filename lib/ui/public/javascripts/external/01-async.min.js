!function(){function n(){}function t(n){var t=!1;return function(){if(t)throw new Error("Callback was already called.");t=!0,n.apply(this,arguments)}}function e(n){var t=!1;return function(){t||(t=!0,n.apply(this,arguments))}}function r(n){return P(n)||"number"==typeof n.length&&n.length>=0&&n.length%1===0}function u(n,t){return r(n)?i(n,t):f(n,t)}function i(n,t){for(var e=-1,r=n.length;++e<r;)t(n[e],e,n)}function o(n,t){for(var e=-1,r=n.length,u=Array(r);++e<r;)u[e]=t(n[e],e,n);return u}function c(n){return o(Array(n),function(n,t){return t})}function a(n,t,e){return i(n,function(n,r,u){e=t(e,n,r,u)}),e}function f(n,t){i(H(n),function(e){t(n[e],e)})}function l(n){var t,e,u=-1;return r(n)?(t=n.length,function(){return u++,t>u?u:null}):(e=H(n),t=e.length,function(){return u++,t>u?e[u]:null})}function s(n,t){t=t||0;var e=-1,r=n.length;t&&(r-=t,r=0>r?0:r);for(var u=Array(r);++e<r;)u[e]=n[e+t];return u}function p(n){return function(t,e,r){return n(t,r)}}function h(t){return function(r,u,i){i=e(i||n),r=r||[];var o=l(r);if(0>=t)return i(null);var c=!1,a=0,f=!1;!function s(){if(c&&0>=a)return i(null);for(;t>a&&!f;){var n=o();if(null===n)return c=!0,void(0>=a&&i(null));a+=1,u(r[n],n,function(n){a-=1,n?(i(n),f=!0):s()})}}()}}function m(n){return function(t,e,r){return n(z.eachOf,t,e,r)}}function d(n,t){return function(e,r,u){return t(h(n),e,r,u)}}function v(n){return function(t,e,r){return n(z.eachOfSeries,t,e,r)}}function g(t,r,u,i){i=e(i||n);var o=[];t(r,function(n,t,e){u(n,function(n,r){o[t]=r,e(n)})},function(n){i(n,o)})}function y(n){return d(n,g)}function k(n,t,e,r){var u=[];t=o(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t,r){e(n.value,function(t){t&&u.push(n),r()})},function(){r(o(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})}function w(n,t,e,r){var u=[];t=o(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t,r){e(n.value,function(t){t||u.push(n),r()})},function(){r(o(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})}function x(t,e,r,u){t(e,function(t,e,i){r(t,function(e){e?(u(t),u=n):i()})},function(){u()})}function O(t,e,u){u=u||n;var i=r(e)?[]:{};t(e,function(n,t,e){n(function(n){var r=s(arguments,1);r.length<=1&&(r=r[0]),i[t]=r,e(n)})},function(n){u(n,i)})}function b(n,t,e,r){var u=[];n(t,function(n,t,r){e(n,function(n,t){u=u.concat(t||[]),r(n)})},function(n){r(n,u)})}function S(e,r,u){function c(t,e,r,u){if(null!=u&&"function"!=typeof u)throw new Error("task callback must be a function");return t.started=!0,P(e)||(e=[e]),0===e.length&&t.idle()?z.setImmediate(function(){t.drain()}):(i(e,function(e){var i={data:e,callback:u||n};r?t.tasks.unshift(i):t.tasks.push(i),t.tasks.length===t.concurrency&&t.saturated()}),void z.setImmediate(t.process))}function a(n,t){return function(){f-=1;var e=arguments;i(t,function(n){n.callback.apply(n,e)}),n.tasks.length+f===0&&n.drain(),n.process()}}if(null==r)r=1;else if(0===r)throw new Error("Concurrency must not be zero");var f=0,l={tasks:[],concurrency:r,saturated:n,empty:n,drain:n,started:!1,paused:!1,push:function(n,t){c(l,n,!1,t)},kill:function(){l.drain=n,l.tasks=[]},unshift:function(n,t){c(l,n,!0,t)},process:function(){if(!l.paused&&f<l.concurrency&&l.tasks.length)for(;f<l.concurrency&&l.tasks.length;){var n=u?l.tasks.splice(0,u):l.tasks.splice(0,l.tasks.length),r=o(n,function(n){return n.data});0===l.tasks.length&&l.empty(),f+=1;var i=t(a(l,n));e(r,i)}},length:function(){return l.tasks.length},running:function(){return f},idle:function(){return l.tasks.length+f===0},pause:function(){l.paused=!0},resume:function(){if(l.paused!==!1){l.paused=!1;for(var n=Math.min(l.concurrency,l.tasks.length),t=1;n>=t;t++)z.setImmediate(l.process)}}};return l}function E(n){return function(t){var e=s(arguments,1);t.apply(null,e.concat([function(t){var e=s(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&i(e,function(t){console[n](t)}))}]))}}function I(n){return function(t,e,r){n(c(t),e,r)}}function T(n,t){function e(){var e=this,r=s(arguments),u=r.pop();return n(t,function(n,t,u){n.apply(e,r.concat([u]))},u)}if(arguments.length>2){var r=s(arguments,2);return e.apply(this,r)}return e}function j(n){return function(){var t=s(arguments),e=t.pop();t.push(function(){var n=arguments;r?z.setImmediate(function(){e.apply(null,n)}):e.apply(null,n)});var r=!0;n.apply(this,t),r=!1}}var A,L,z={};A="object"==typeof window&&this===window?window:"object"==typeof global&&this===global?global:this,null!=A&&(L=A.async),z.noConflict=function(){return A.async=L,z};var q,C=Object.prototype.toString,P=Array.isArray||function(n){return"[object Array]"===C.call(n)},H=Object.keys||function(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t};"function"==typeof setImmediate&&(q=setImmediate),"undefined"!=typeof process&&process.nextTick?(z.nextTick=process.nextTick,z.setImmediate=q?function(n){q(n)}:z.nextTick):q?(z.nextTick=function(n){q(n)},z.setImmediate=z.nextTick):(z.nextTick=function(n){setTimeout(n,0)},z.setImmediate=z.nextTick),z.forEach=z.each=function(n,t,e){return z.eachOf(n,p(t),e)},z.forEachSeries=z.eachSeries=function(n,t,e){return z.eachOfSeries(n,p(t),e)},z.forEachLimit=z.eachLimit=function(n,t,e,r){return h(t)(n,p(e),r)},z.forEachOf=z.eachOf=function(r,i,o){function c(n){n?o(n):(f+=1,f>=a&&o(null))}o=e(o||n),r=r||[];var a=r.length||H(r).length,f=0;return a?void u(r,function(n,e){i(r[e],e,t(c))}):o(null)},z.forEachOfSeries=z.eachOfSeries=function(t,r,u){function i(){var n=!0,e=o();return null===e?u(null):(r(t[e],e,function(t){t?u(t):n?z.nextTick(i):i()}),void(n=!1))}u=e(u||n),t=t||[];var o=l(t);i()},z.forEachOfLimit=z.eachOfLimit=function(n,t,e,r){h(t)(n,e,r)},z.map=m(g),z.mapSeries=v(g),z.mapLimit=function(n,t,e,r){return y(t)(n,e,r)},z.inject=z.foldl=z.reduce=function(n,t,e,r){z.eachOfSeries(n,function(n,r,u){e(t,n,function(n,e){t=e,u(n)})},function(n){r(n||null,t)})},z.foldr=z.reduceRight=function(n,t,e,r){var u=o(n,function(n){return n}).reverse();z.reduce(u,t,e,r)},z.select=z.filter=m(k),z.selectSeries=z.filterSeries=v(k),z.reject=m(w),z.rejectSeries=v(w),z.detect=m(x),z.detectSeries=v(x),z.any=z.some=function(t,e,r){z.eachOf(t,function(t,u,i){e(t,function(t){t&&(r(!0),r=n),i()})},function(){r(!1)})},z.all=z.every=function(t,e,r){z.eachOf(t,function(t,u,i){e(t,function(t){t||(r(!1),r=n),i()})},function(){r(!0)})},z.sortBy=function(n,t,e){function r(n,t){var e=n.criteria,r=t.criteria;return r>e?-1:e>r?1:0}z.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){return n?e(n):void e(null,o(t.sort(r),function(n){return n.value}))})},z.auto=function(t,r){function u(n){h.unshift(n)}function o(n){for(var t=0;t<h.length;t+=1)if(h[t]===n)return void h.splice(t,1)}function c(){l--,i(h.slice(0),function(n){n()})}r=e(r||n);var f=H(t),l=f.length;if(!l)return r(null);var p={},h=[];u(function(){l||r(null,p)}),i(f,function(n){function e(t){var e=s(arguments,1);if(e.length<=1&&(e=e[0]),t){var u={};i(H(p),function(n){u[n]=p[n]}),u[n]=e,r(t,u)}else p[n]=e,z.setImmediate(c)}function f(){return a(d,function(n,t){return n&&p.hasOwnProperty(t)},!0)&&!p.hasOwnProperty(n)}function l(){f()&&(o(l),m[m.length-1](e,p))}for(var h,m=P(t[n])?t[n]:[t[n]],d=m.slice(0,Math.abs(m.length-1))||[],v=d.length;v--;){if(!(h=t[d[v]]))throw new Error("Has inexistant dependency");if(P(h)&&~h.indexOf(n))throw new Error("Has cyclic dependencies")}f()?m[m.length-1](e,p):u(l)})},z.retry=function(n,t,e){function r(r,u){function o(n,t){return function(e){n(function(n,r){e(!n||t,{err:n,result:r})},u)}}for(;n;)i.push(o(t,!(n-=1)));z.series(i,function(n,t){t=t[t.length-1],(r||e)(t.err,t.result)})}var u=5,i=[];return"function"==typeof n&&(e=t,t=n,n=u),n=parseInt(n,10)||u,e?r():r},z.waterfall=function(t,r){function u(n){return function(t){if(t)r.apply(null,arguments);else{var e=s(arguments,1),i=n.next();e.push(i?u(i):r),j(n).apply(null,e)}}}if(r=e(r||n),!P(t)){var i=new Error("First argument to waterfall must be an array of functions");return r(i)}return t.length?void u(z.iterator(t))():r()},z.parallel=function(n,t){O(z.eachOf,n,t)},z.parallelLimit=function(n,t,e){O(h(t),n,e)},z.series=function(t,e){e=e||n;var u=r(t)?[]:{};z.eachOfSeries(t,function(n,t,e){n(function(n){var r=s(arguments,1);r.length<=1&&(r=r[0]),u[t]=r,e(n)})},function(n){e(n,u)})},z.iterator=function(n){function t(e){function r(){return n.length&&n[e].apply(null,arguments),r.next()}return r.next=function(){return e<n.length-1?t(e+1):null},r}return t(0)},z.apply=function(n){var t=s(arguments,1);return function(){return n.apply(null,t.concat(s(arguments)))}},z.concat=m(b),z.concatSeries=v(b),z.whilst=function(n,t,e){n()?t(function(r){return r?e(r):void z.whilst(n,t,e)}):e(null)},z.doWhilst=function(n,t,e){n(function(r){if(r)return e(r);var u=s(arguments,1);t.apply(null,u)?z.doWhilst(n,t,e):e(null)})},z.until=function(n,t,e){n()?e(null):t(function(r){return r?e(r):void z.until(n,t,e)})},z.doUntil=function(n,t,e){n(function(r){if(r)return e(r);var u=s(arguments,1);t.apply(null,u)?e(null):z.doUntil(n,t,e)})},z.queue=function(n,t){var e=S(function(t,e){n(t[0],e)},t,1);return e},z.priorityQueue=function(t,e){function r(n,t){return n.priority-t.priority}function u(n,t,e){for(var r=-1,u=n.length-1;u>r;){var i=r+(u-r+1>>>1);e(t,n[i])>=0?r=i:u=i-1}return r}function o(t,e,o,c){if(null!=c&&"function"!=typeof c)throw new Error("task callback must be a function");return t.started=!0,P(e)||(e=[e]),0===e.length?z.setImmediate(function(){t.drain()}):void i(e,function(e){var i={data:e,priority:o,callback:"function"==typeof c?c:n};t.tasks.splice(u(t.tasks,i,r)+1,0,i),t.tasks.length===t.concurrency&&t.saturated(),z.setImmediate(t.process)})}var c=z.queue(t,e);return c.push=function(n,t,e){o(c,n,t,e)},delete c.unshift,c},z.cargo=function(n,t){return S(n,1,t)},z.log=E("log"),z.dir=E("dir"),z.memoize=function(n,t){function e(){var e=s(arguments),i=e.pop(),o=t.apply(null,e);o in r?z.nextTick(function(){i.apply(null,r[o])}):o in u?u[o].push(i):(u[o]=[i],n.apply(null,e.concat([function(){r[o]=s(arguments);var n=u[o];delete u[o];for(var t=0,e=n.length;e>t;t++)n[t].apply(null,arguments)}])))}var r={},u={};return t=t||function(n){return n},e.memo=r,e.unmemoized=n,e},z.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},z.times=I(z.map),z.timesSeries=I(z.mapSeries),z.timesLimit=function(n,t,e,r){return z.mapLimit(c(n),t,e,r)},z.seq=function(){var t=arguments;return function(){var e=this,r=s(arguments),u=r.slice(-1)[0];"function"==typeof u?r.pop():u=n,z.reduce(t,r,function(n,t,r){t.apply(e,n.concat([function(){var n=arguments[0],t=s(arguments,1);r(n,t)}]))},function(n,t){u.apply(e,[n].concat(t))})}},z.compose=function(){return z.seq.apply(null,Array.prototype.reverse.call(arguments))},z.applyEach=function(){var n=s(arguments);return T.apply(null,[z.eachOf].concat(n))},z.applyEachSeries=function(){var n=s(arguments);return T.apply(null,[z.eachOfSeries].concat(n))},z.forever=function(e,r){function u(n){return n?i(n):void o(u)}var i=t(r||n),o=j(e);u()},z.ensureAsync=j,"undefined"!=typeof module&&module.exports?module.exports=z:"undefined"!=typeof define&&define.amd?define([],function(){return z}):A.async=z}();